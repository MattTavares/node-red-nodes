<!--
  Copyright 2016 Pimoroni Ltd

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/javascript">
    RED.nodes.registerType("rpi-explorerhat in",{
        category: "Raspberry Pi",
        paletteLabel: "Explorer HAT",
        color: '#c6dbef',
        defaults: {
            name: { value: "" },
            touch: { value: true },
            input: { value: true },
            analog: { value: true }
        },
        inputs:0,
        outputs:1,
        icon:  "rpi.png",
        label: function() {
            return this.name||"Explorer HAT";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        }
    });
</script>

<script type="text/x-red" data-template-name="rpi-explorerhat in">
<div class="form-row">
    <label><i class="fa fa-arrow-right"></i> Outputs</label>
    <label style="width: auto" for="node-input-touch"><input style="vertical-align: top; width: auto; margin-right: 5px;" type="checkbox" id="node-input-touch"> Touch events</label>
    <div style="padding-left: 125px; margin-top: -5px; color: #bbb;">Touch pads 1, 2, 3, 4, 5, 6, 7 and 8</div>
</div>
<div class="form-row">
    <label></label>
    <label style="width: auto" for="node-input-input"><input style="vertical-align: top; width: auto; margin-right: 5px;" type="checkbox" id="node-input-input"> Input events</label>
    <div style="padding-left: 125px; margin-top: -5px; color: #bbb;">5v tolerant inputs 1, 2, 3 and 4</div>
</div>
<div class="form-row">
    <label></label>
    <label style="width: auto" for="node-input-analog"><input style="vertical-align: top; width: auto; margin-right: 5px;" type="checkbox" id="node-input-analog"> Analog events</label>
    <div style="padding-left: 125px; margin-top: -5px; color: #bbb;">5v tolerant analog inputs 1, 2, 3 and 4</div>
</div>

<div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name">
</div>
</script>

<script type="text/x-red" data-help-name="rpi-explorerhat in">
<p>Raspberry Pi Explorer HAT input node.</p>
<p>This node sends readings from the various inputs on Explorer HAT, grouped into three sets; touch events, input events and analog events.</p>

<p><b>Touch Events</b></p>
<p>Touch events are generated by the 8 touch-sensitive pads on Explorer HAT. A message will be sent every time a touch pad is touched, or released. The <code>topic</code> is set to <code>touch</code> and the <code>payload</code> is an object with the following values:</p>
<ul>
    <li><code>touch.1</code> : the touched status of touch pad 1. 1 for touched, 0 for released.</li>
    <li><code>touch.2</code> : the touched status of touch pad 2. 1 for touched, 0 for released.</li>
    <li>and so on&hellip;</li>
</ul>

<p><b>Input Events</b></p>
<p>Input events are generated by the four 5v tolerant protected inputs on Explorer HAT. A message will be sent every time an input changes. The <code>topic</code> is set to <code>input</code> and the <code>payload</code> is an object with the following values:</p>
<ul>
    <li><code>input.1</code> : the pin status of input 1. 1 if it's HIGH, 0 if it's LOW.</li>
    <li><code>input.2</code> : the pin status of input 2. 1 if it's HIGH, 0 if it's LOW.</li>
    <li>and so on&hellip;</li>
</ul>

<p><b>Analog Events</b></p>
<p>Analog events are generated by the four 5v tolerant analog inputs on Explorer HAT. A message will be sent when the analog value changes by 10mV or more, giving 500 steps of granularity. The <code>topic</code> is set to <code>analog</code> and the <code>payload</code> is an object with the following values:</p>
<ul>
    <li><code>analog.1</code> : the value of analog input 1. Values are expressed in volts from 0.0v to 5.0v.</li>
    <li><code>analog.2</code> : the value of analog input 2. Values are expressed in volts from 0.0v to 5.0v.</li>
    <li>and so on&hellip;</li>
</ul>
</script>
